"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{5814:function(e,a,l){l.d(a,{V:function(){return j}});var n=l(7437),t=l(2151),s=l.n(t),o=l(7907),r=l(5309),i=l(2265),c=l(8034),d=l(6468),m=l(6274),u=l(620),x=l(2021),f=l(5507),h=l(2111),p=l(2840);let b=new Date;function j(e){let{isCopy:a,tableName:l}=e,t=l||c.H$.TRANSACOES,j=(0,o.useSearchParams)().get("month"),N=s()(j,"YYYY-MM"),g=(0,o.useRouter)(),{isDbOk:y,repository:C}=(0,r.y$)(),[w,S]=(0,i.useState)(!0),[Y,D]=(0,i.useState)(b),[F,k]=(0,i.useState)([]),[M,A]=(0,i.useState)([]),[E,I]=(0,i.useState)(),[L,O]=(0,i.useState)(!1),R=t===c.H$.SALDOS;async function $(){S(!0);let e=await C.listByMonth(t,N.format("MM"),N.format("YYYY"));a&&e.forEach(e=>{delete e.id,delete e.createdDate,delete e.updatedDate,e.data=b}),k(e),S(!1)}async function P(){if(!confirm("Voc\xea tem certeza?"))return;S(!0);let e=[...F];a&&e.forEach(e=>{e.data=e.data===b?Y:e.data}),e.forEach((e,a)=>{e.ordem=a}),await Promise.all(M.filter(e=>e.id).map(e=>C.delete(t,e.id))),await C.saveAll(t,e),S(!1),g.push(R?"/saldos":"/caixa")}function V(e){let a=F.indexOf(e),l=[...F];l.splice(a,1),k(l),A([...M,e])}(0,i.useEffect)(()=>{y&&$()},[y]);let Z=F.filter(e=>null==e?void 0:e.valor).reduce((e,a)=>a.valor.plus(e),(0,p.Z)(0));return(0,n.jsxs)(n.Fragment,{children:[w?(0,n.jsx)(d.a,{className:"align-self-center my-5"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center align-items-lg-end flex-column flex-lg-row gap-3",children:[(0,n.jsx)(v,{total:Z}),(0,n.jsx)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:(0,n.jsx)("button",{type:"button",className:"btn btn-dark",onClick:e=>O(!0),children:"Adicionar nova"})})]}),(0,n.jsx)(h.Z5,{onDragEnd:function(e){var a;console.log(arguments);let l=[...F],n=null===(a=e.destination)||void 0===a?void 0:a.index,t=e.source.index,s=l[t];l.splice(t,1),l.splice(n,0,s),k(l)},children:(0,n.jsx)(h.bK,{droppableId:"droppable",children:(e,a)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("ul",{...e.droppableProps,className:"list-group ".concat(a.isDraggingOver&&"text-bg-dark"),ref:e.innerRef,children:F.map((e,a)=>(0,n.jsx)(h._l,{draggableId:"".concat(e.local,":").concat(a),index:a,children:(a,l)=>{var t,o;return(0,n.jsxs)("li",{ref:a.innerRef,...a.draggableProps,...a.dragHandleProps,style:a.draggableProps.style,className:"list-group-item ".concat(!(null===(t=e.valor)||void 0===t?void 0:t.toNumber())&&"list-group-item-warning"," ").concat(l.isDragging&&"active"),children:[(0,n.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,n.jsx)("h5",{children:e.local}),(0,n.jsxs)("div",{className:"d-flex justify-content-between gap-3",children:[(0,n.jsx)("small",{children:s()(e.data).format("DD/MM/YY")}),void 0!==e.tipo&&(0,n.jsx)("small",{className:e.tipo===c.$P.FIXO?"text-primary":"text-info",children:e.tipo===c.$P.FIXO?"Fixo":"Vari\xe1vel"})]})]}),(0,n.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,n.jsx)("p",{children:(null===(o=e.valor)||void 0===o?void 0:o.toNumber())?m.C.toCurrency(e.valor):"sem valor"}),(0,n.jsxs)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:[(0,n.jsx)("button",{className:"btn btn-secondary",onClick:a=>I(e),children:"Editar"}),(0,n.jsx)("button",{className:"btn btn-danger",onClick:a=>V(e),children:"Remover"})]})]}),(0,n.jsx)("small",{children:e.comentario})]})}},"".concat(e.local,":").concat(a)))}),e.placeholder]})})}),(0,n.jsx)("div",{className:"d-flex justify-content-center justify-content-lg-end",children:(0,n.jsxs)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:[(0,n.jsx)(v,{total:Z}),a&&(0,n.jsxs)("div",{className:"form-floating",children:[(0,n.jsx)(u.I,{type:"month",className:"form-control",id:"data",placeholder:"M\xeas a aplicar",value:Y,onChange:e=>D(e)}),(0,n.jsx)("label",{htmlFor:"data",className:"form-label",children:"M\xeas a aplicar"})]}),(0,n.jsx)("button",{type:"button",className:"btn btn-primary",onClick:e=>P(),children:a?"Copiar transa\xe7\xf5es para o m\xeas":"Salvar transa\xe7\xf5es do m\xeas"})]})})]}),E&&(0,n.jsx)(x.u,{hideFooter:!0,onClose:()=>I(null),title:"Detalhes da transa\xe7\xe3o: ".concat(null==E?void 0:E.local),children:(0,n.jsx)(f.m,{transacao:E,cleanStyle:!0,onClose:()=>I(null),onCustomSubmit:e=>(function(e,a){let l=F.indexOf(e),n=[...F];n[l]={...a},k(n)})(E,e),onCustomDelete:e=>V(E)})}),L&&(0,n.jsx)(x.u,{hideFooter:!0,onClose:()=>O(!1),title:"Adicionar transa\xe7\xe3o",children:(0,n.jsx)(f.m,{cleanStyle:!0,onClose:()=>O(!1),onCustomSubmit:e=>(function(e){let a=[...F];a.push(e),k(a)})(e),onCustomDelete:e=>O(!1)})})]})}function v(e){let{total:a}=e;return(0,n.jsxs)("div",{className:"d-flex gap-3",children:[(0,n.jsx)("h5",{children:"Balan\xe7o do m\xeas"}),(0,n.jsxs)("div",{className:"d-flex flex-column",children:[(0,n.jsx)("p",{className:"m-0",children:m.C.toCurrency(a)}),(0,n.jsx)("small",{children:m.C.extenso(a)})]})]})}},5507:function(e,a,l){l.d(a,{m:function(){return c}});var n=l(7437),t=l(8034),s=l(620),o=l(2265),r=l(2840),i=l(5309);function c(e){let{transacao:a,cleanStyle:l,onClose:c,onCustomSubmit:m,onCustomDelete:u,tableName:x}=e,{isDbOk:f,repository:h,refresh:p}=(0,i.y$)(),[b,j]=(0,o.useState)((null==a?void 0:a.valor)||(0,r.Z)()),[v,N]=(0,o.useState)((null==a?void 0:a.data)||new Date),[g,y]=(0,o.useState)(null==a?void 0:a.tipo),[C,w]=(0,o.useState)(null==a?void 0:a.local),[S,Y]=(0,o.useState)(null==a?void 0:a.comentario),[D,F]=(0,o.useState)(!1),k=x||t.H$.TRANSACOES;async function M(e){e.preventDefault(),F(!0);let l={...a,valor:b,data:v,tipo:g,local:C,comentario:S};k===t.H$.SALDOS&&delete l.tipo,null==m?(console.info("onSubmitForm",await h.save(k,l)),await p()):m(l),F(!1),c&&c()}async function A(){if(F(!0),null==a)throw Error("transacao invalida");null==u?(console.info("onDelete",await h.delete(k,a.id)),p()):u(a),F(!1),c&&c()}return(0,n.jsxs)("form",{className:"transacao-form w-100 ".concat(!l&&"card"),onSubmit:M,children:[!l&&(0,n.jsx)("h5",{className:"card-header",children:"Adicione uma nova transa\xe7\xe3o"}),(0,n.jsxs)("div",{className:"d-flex flex-column px-3 py-2 gap-3",children:[(0,n.jsxs)("div",{className:"d-flex gap-3 flex-column flex-md-row w-100",children:[(0,n.jsxs)("div",{className:"flex-grow-1",children:[(0,n.jsx)("label",{htmlFor:"local",className:"form-label",children:"Local"}),(0,n.jsx)(s.I,{type:"text",className:"form-control",id:"local",onChange:e=>w(e),value:C,placeholder:"Local"})]}),(0,n.jsxs)("div",{className:"flex-grow-1",children:[(0,n.jsx)("label",{htmlFor:"comentario",className:"form-label",children:"Comentario (OBS)"}),(0,n.jsx)(s.I,{type:"text",className:"form-control",id:"comentario",onChange:e=>Y(e),value:S,placeholder:"Comentario (OBS)"})]})]}),(0,n.jsxs)("div",{className:"d-flex gap-3 flex-column flex-md-row w-100",children:[(0,n.jsxs)("div",{className:"flex-grow-1",children:[(0,n.jsx)("label",{htmlFor:"valorAplicado",className:"form-label",children:"Valor aplicado"}),(0,n.jsx)(s.I,{type:"number",className:"form-control",id:"valorAplicado",groupSymbolLeft:"R$",onChange:e=>j(e),value:b})]}),(0,n.jsxs)("div",{className:"flex-grow-1",children:[(0,n.jsx)("label",{htmlFor:"data",className:"form-label",children:"Data"}),(0,n.jsx)(s.I,{type:"date",className:"form-control",id:"data",onChange:e=>N(e),value:v})]}),k!==t.H$.SALDOS?(0,n.jsxs)("div",{className:"flex-grow-1",children:[(0,n.jsx)("label",{htmlFor:"tipoReceita",className:"form-label",children:"Tipo de receita"}),(0,n.jsxs)("select",{className:"form-select",id:"tipoReceita",onChange:e=>y(Number(e.target.value)),defaultValue:g,children:[(0,n.jsx)("option",{value:t.$P.VARIAVEL,children:"Vari\xe1vel"}),(0,n.jsx)("option",{value:t.$P.FIXO,children:"Fixo"})]})]}):null]}),(0,n.jsx)(d,{isAllLoading:!f||D,transacao:a,onClose:c,onDelete:A})]})]})}function d(e){let{isAllLoading:a,transacao:l,onClose:t,onDelete:s}=e,o="Adicionar";return null!=l&&(o="Salvar"),(0,n.jsxs)("div",{className:"d-flex gap-2 justify-content-end",children:[t&&(0,n.jsx)("button",{type:"button",onClick:t,className:"btn btn-secondary align-self-end mt-2",disabled:a,children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"spinner-border spinner-border-sm","aria-hidden":"true"}),(0,n.jsxs)("span",{role:"status",children:[" ","Carregando..."]})]}):"Fechar"}),l&&s&&(0,n.jsx)("button",{type:"button",onClick:s,className:"btn btn-danger align-self-end mt-2",disabled:a,children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"spinner-border spinner-border-sm","aria-hidden":"true"}),(0,n.jsxs)("span",{role:"status",children:[" ","Carregando..."]})]}):"Remover"}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary align-self-end mt-2",disabled:a,children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"spinner-border spinner-border-sm","aria-hidden":"true"}),(0,n.jsxs)("span",{role:"status",children:[" ","Carregando..."]})]}):o})]})}},620:function(e,a,l){l.d(a,{I:function(){return r}});var n=l(7437),t=l(2840),s=l(2151),o=l.n(s);function r(e){let{onChange:a,isNumber:l,groupSymbolLeft:s,groupSymbolRight:r,isPercent:i,value:c,...d}=e,m="number"===e.type||l,u="date"===e.type,x="month"===e.type,f=m?function(e,a){let{isPercent:l}=a;return null==e||isNaN(e.toNumber())?"":l?e.times(100).toNumber():e.toNumber()}(c,{isPercent:i}):u?o()(c).format("YYYY-MM-DD"):x?o()(c).format("YYYY-MM"):c||"",h=(0,n.jsx)("input",{className:"form-control",onChange:function(e){let{value:l}=e.target;(a||function(){})(i?(0,t.Z)(l).div(100):m?(0,t.Z)(l):u?o()(l,"YYYY-MM-DD").toDate():x?o()(l,"YYYY-MM").toDate():l)},value:f,...d});return s||r?(0,n.jsxs)("div",{className:"input-group mb-3",children:[s&&(0,n.jsx)("span",{className:"input-group-text",children:s}),h,r&&(0,n.jsx)("span",{className:"input-group-text",children:r})]}):h}},2021:function(e,a,l){l.d(a,{u:function(){return s}});var n=l(7437),t=l(2265);function s(e){let{children:a,title:l,onClose:s,hideFooter:o}=e,[r,i]=(0,t.useState)(!0);function c(){i(!1),s&&s()}function d(e){var a;(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.id)==="modal"&&c()}function m(e){(null==e?void 0:e.key)==="Escape"&&c()}return(0,t.useEffect)(()=>(document.addEventListener("keydown",m,!1),()=>{document.removeEventListener("keydown",m,!1)}),[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"modal modal-lg fade ".concat(r&&"show"),id:"modal",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",style:{zIndex:99,display:r?"block":"none"},onClick:d,children:(0,n.jsx)("div",{className:"modal-dialog",children:(0,n.jsxs)("div",{className:"modal-content",children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:l}),(0,n.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:c})]}),(0,n.jsx)("div",{className:"modal-body",children:a}),!o&&(0,n.jsx)("div",{className:"modal-footer",children:(0,n.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:c,children:"Close"})})]})})}),(0,n.jsx)("div",{className:"modal-backdrop fade ".concat(r&&"show"),style:{zIndex:98},onClick:d})]})}},6274:function(e,a,l){l.d(a,{C:function(){return r}});var n=l(2840),t=l(6947),s=l.n(t);let o=new Intl.NumberFormat("pt-br",{style:"currency",currency:"BRL"});class r{static extenso(e,a){var l;return(e instanceof n.Z&&(e=null==e?void 0:null===(l=e.integerValue())||void 0===l?void 0:l.toNumber()),null==e||isNaN(e)||!isFinite(e))?"":s()(e,a)}static toCurrency(e,a){return("string"==typeof e&&(e=Number(e)),e instanceof n.Z&&(e=null==e?void 0:e.toNumber()),null==e||isNaN(e)||!isFinite(e))?"":o.format(e)}}}}]);