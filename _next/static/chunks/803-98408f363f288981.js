"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[803],{7644:function(e,a,t){t.d(a,{w:function(){return o}});var l=t(7437),n=t(8034);let s=[{title:"ultimo mes",value:n.Jd.ULTIMO_MES},{title:"3 ultimos meses",value:n.Jd.TRES_ULTIMOS_MESES},{title:"6 ultimos meses",value:n.Jd.SEIS_ULTIMOS_MESES},{title:"ultimo ano",value:n.Jd.ULTIMO_ANO},{title:"todo historico",value:n.Jd.TODO_HISTORICO}];function o(e){let{onChange:a,value:t}=e;return(0,l.jsxs)("form",{className:"periodo-form card",children:[(0,l.jsx)("h5",{className:"card-header",children:"Escolha o periodo"}),(0,l.jsx)("div",{className:"d-xl-none my-3 px-3",children:(0,l.jsx)("select",{className:"form-select",id:"tipoReceita",onChange:e=>a(Number(e.target.value)),defaultValue:t,children:s.map((e,a)=>(0,l.jsx)("option",{value:e.value,children:e.title},e.value))})}),(0,l.jsx)("div",{className:"d-none d-xl-flex btn-group my-3 px-3",children:s.map((e,n)=>(0,l.jsxs)("label",{className:"btn btn-outline-secondary ".concat(e.value===t&&"active"),htmlFor:"periodosTransacoes".concat(n),children:[(0,l.jsx)("input",{type:"radio",className:"btn-check",name:"periodosTransacoes",id:"periodosTransacoes".concat(n),value:e.value,onChange:e=>a(Number(e.target.value)),checked:e.value===t}),e.title]},e.value))})]})}},5507:function(e,a,t){t.d(a,{m:function(){return d}});var l=t(7437),n=t(8034),s=t(620),o=t(2265),r=t(2840),i=t(3694),c=t(648);function d(e){let{transacao:a,cleanStyle:t,onClose:d,onCustomSubmit:x,onCustomDelete:h,tableName:b}=e,v=b||n.H$.TRANSACOES,{isDbOk:p,repository:j,refresh:N}=(0,i.y)(),{isMobile:g}=(0,c.k)(),[y,w]=(0,o.useState)((null==a?void 0:a.valor)||(0,r.Z)()),[C,S]=(0,o.useState)((null==a?void 0:a.data)||new Date),[M,O]=(0,o.useState)(null==a?void 0:a.tipo),[E,I]=(0,o.useState)(null==a?void 0:a.local),[Y,k]=(0,o.useState)(null==a?void 0:a.comentario),[A,R]=(0,o.useState)(!1),F=v===n.H$.PATRIMONIO;async function T(e){e.preventDefault(),R(!0);let t={...a,valor:y,data:C,tipo:M,local:E,comentario:Y};v===n.H$.PATRIMONIO&&delete t.tipo,null==x?(console.info("onSubmitForm",await j.save(v,t)),await N()):x(t),R(!1),d&&d()}async function D(){if(R(!0),null==a)throw Error("transacao invalida");null==h?(console.info("onDelete",await j.delete(v,a.id)),N()):h(a),R(!1),d&&d()}return(0,l.jsxs)("form",{className:"transacao-form w-100 ".concat(!t&&"card"),onSubmit:T,children:[!t&&(0,l.jsx)("h5",{className:"card-header",children:"Adicionar novo(a)"}),(0,l.jsxs)("div",{className:"d-flex flex-column px-3 py-2 gap-3",children:[(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column flex-md-row w-100",children:[(0,l.jsxs)("div",{className:"flex-grow-1 ".concat(!F&&"w-100"),children:[(0,l.jsx)("label",{htmlFor:"local",className:"form-label",children:"Local"}),(0,l.jsx)(s.I,{type:"text",className:"form-control",id:"local",onChange:e=>I(e),value:E,placeholder:"Local"})]}),(0,l.jsxs)("div",{className:"flex-grow-1",children:[(0,l.jsx)("label",{htmlFor:"valorAplicado",className:"form-label",children:"Valor aplicado"}),(0,l.jsx)(s.I,{type:"number",className:"form-control",id:"valorAplicado",groupSymbolLeft:"R$",onChange:e=>w(e),value:y})]}),F?(0,l.jsx)(u,{data:C,setData:S,isPatrimonio:F}):null]}),(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column flex-md-row w-100",children:[(0,l.jsx)(m,{comentario:Y,setComentario:k}),(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column",children:[F?null:(0,l.jsx)(u,{data:C,setData:S,isPatrimonio:F}),F?null:(0,l.jsxs)("div",{className:"flex-grow-1",children:[(0,l.jsx)("label",{htmlFor:"tipoReceita",className:"form-label",children:"Tipo de receita"}),(0,l.jsxs)("select",{className:"form-select ".concat(!g&&"form-control-sm"),id:"tipoReceita",onChange:e=>O(Number(e.target.value)),defaultValue:M,children:[(0,l.jsx)("option",{value:n.$P.VARIAVEL,children:"Vari\xe1vel"}),(0,l.jsx)("option",{value:n.$P.FIXO,children:"Fixo"})]})]})]})]}),(0,l.jsx)(f,{isAllLoading:!p||A,transacao:a,onClose:d,onDelete:D,onReset:function(){w((0,r.Z)()),S(new Date),O(n.$P.VARIAVEL),I(""),k("")}})]})]})}function u(e){let{setData:a,data:t,isPatrimonio:n}=e,{isMobile:o}=(0,c.k)();return(0,l.jsxs)("div",{className:"flex-grow-1",children:[(0,l.jsx)("label",{htmlFor:"data",className:"form-label",children:"Data"}),(0,l.jsx)(s.I,{type:"date",className:"form-control ".concat(!o&&!n&&"form-control-sm"),id:"data",onChange:e=>a(e),value:t})]})}function m(e){let{setComentario:a,comentario:t}=e;return(0,l.jsxs)("div",{className:"flex-grow-1 d-flex flex-column",children:[(0,l.jsx)("label",{htmlFor:"comentario",className:"form-label",children:"Comentario (OBS)"}),(0,l.jsx)(s.I,{type:"mdtextarea",className:"form-control h-100",id:"comentario",onChange:e=>a(e),value:t,placeholder:"Comentario (OBS)"})]})}function f(e){let{isAllLoading:a,transacao:t,onClose:n,onDelete:s,onReset:o}=e,r="Adicionar";null!=t&&(r="Salvar");let i=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"spinner-border spinner-border-sm","aria-hidden":"true"}),(0,l.jsxs)("span",{role:"status",children:[" ","..."]})]});return(0,l.jsxs)("div",{className:"d-flex gap-2 justify-content-end",children:[n&&(0,l.jsx)("button",{type:"button",onClick:n,className:"btn btn-secondary align-self-end mt-2",disabled:a,children:a?i:"Fechar"}),t&&s&&(0,l.jsx)("button",{type:"button",onClick:s,className:"btn btn-danger align-self-end mt-2",disabled:a,children:a?i:"Remover"}),o&&(0,l.jsx)("button",{type:"button",onClick:o,className:"btn btn-light align-self-end mt-2",disabled:a,children:"Limpar campos"}),(0,l.jsx)("button",{type:"submit",className:"btn btn-primary align-self-end mt-2",disabled:a,children:a?i:r})]})}},2163:function(e,a,t){t.d(a,{B:function(){return N}});var l=t(7437),n=t(2151),s=t.n(n),o=t(6468),r=t(6274),i=t(8034),c=t(2265),d=t(2021),u=t(5507);function m(e){let{transacoesDoPeriodo:a,tableName:t}=e,n=t||i.H$.TRANSACOES,[o,m]=(0,c.useState)(null);return(0,l.jsxs)("ul",{className:"list-group",children:[a.map((e,a)=>{var t;return(0,l.jsxs)("li",{className:"list-group-item ".concat(null!==(t=e.valor)&&void 0!==t?t:"list-group-item-warning"),children:[(0,l.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,l.jsx)("h5",{children:e.local}),(0,l.jsxs)("div",{className:"d-flex justify-content-between gap-3 flex-column flex-lg-row",children:[(0,l.jsx)("small",{children:s()(e.data).format("DD/MM/YY")}),void 0!==e.tipo&&(0,l.jsx)("small",{className:e.tipo===i.$P.FIXO?"text-primary":"text-info",children:e.tipo===i.$P.FIXO?"Fixo":"Vari\xe1vel"})]})]}),(0,l.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,l.jsx)("p",{children:e.valor?r.C.toCurrency(e.valor):"sem valor"}),(0,l.jsx)("button",{className:"btn btn-secondary",onClick:a=>m(e),children:"Editar"})]}),(0,l.jsx)("small",{children:e.comentario})]},"".concat(e.local,":").concat(a))}),o&&(0,l.jsx)(d.u,{hideFooter:!0,onClose:()=>m(null),title:"Detalhes da transa\xe7\xe3o: ".concat(null==o?void 0:o.local),children:(0,l.jsx)(u.m,{tableName:n,transacao:o,cleanStyle:!0,onClose:()=>m(null)})})]})}var f=t(1196),x=t(2840);function h(e){let{transacoesDoPeriodo:a,transacoesAcumuladasPorMes:t}=e,n=a.reduce((e,a)=>e.plus(a.valor||0),(0,x.Z)(0));return(0,l.jsxs)("div",{className:"totals",children:[(0,l.jsx)("h5",{children:"Balan\xe7o do mes"}),(0,l.jsx)("p",{children:r.C.toCurrency(n)}),(0,l.jsx)("small",{children:r.C.extenso(n)}),(0,l.jsx)(v,{transacoesAcumuladasPorMes:t}),(0,l.jsx)(b,{transacoesDoPeriodo:a})]})}function b(e){let{transacoesDoPeriodo:a}=e,t=a.filter(e=>{var a;return e.valor&&(null===(a=e.valor)||void 0===a?void 0:a.toNumber())>=0}).reduce((e,a)=>e.plus(a.valor||0),(0,x.Z)(0)),n=a.filter(e=>{var a;return e.valor&&(null===(a=e.valor)||void 0===a?void 0:a.toNumber())<0}).reduce((e,a)=>e.plus(a.valor||0),(0,x.Z)(0));return(0,l.jsx)(f.$I,{data:{labels:["Entradas","Saidas"],datasets:[{label:"soma em reais (R$)",data:[t,n],backgroundColor:["#65a148","#dc3545"],hoverOffset:4}]},options:{responsive:!0,plugins:{legend:{position:"bottom"}}}})}function v(e){let{transacoesAcumuladasPorMes:a}=e;return(0,l.jsx)(f.x1,{data:{labels:a.map(e=>e.mes),datasets:[{label:"acumulado at\xe9 o mes (R$)",data:a.map(e=>e.totalAcumulado)}]},options:{responsive:!0,plugins:{legend:{position:"bottom"}}}})}var p=t(8792),j=t(3694);function N(e){let{groupByDay:a,periodo:t,transacoesAcumuladaPorMes:n,tableName:d}=e,{isDbOk:u,repository:f,refresh:b}=(0,j.y)(),[v,N]=(0,c.useState)(!0),[g,y]=(0,c.useState)({}),w=d||i.H$.TRANSACOES,C=a?"YYYY-MM-DD":"YYYY-MM",S=a?"DD MMMM YYYY":"MMMM YYYY";async function M(){N(!0),await O(),N(!1)}async function O(){y((w===i.H$.PATRIMONIO?await f.patrimonio.listPatrimonio(t):await f.transacoes.listCaixa(t)).reduce((e,a)=>{let t=s()(a.data).format(C),l=e[t]||[];return l.push(a),e[t]=l,e},{}))}async function E(e){confirm("Voc\xea tem certeza que deseja remover o m\xeas?")&&(await f.transacoes.deletePeriod(e.format("MM"),e.format("YYYY")),await b())}(0,c.useEffect)(()=>{u&&M()},[u,t]);let I=Object.keys(g),Y=w===i.H$.PATRIMONIO,k=Y?"patrimonio":"caixa";return(0,l.jsx)("section",{className:"periodos",children:v?(0,l.jsx)(o.a,{className:"align-self-center my-5"}):0===I.length?(0,l.jsx)("div",{className:"alert alert-info my-3",role:"alert",children:"Nenhum dado encontrado"}):I.map(e=>{let a=g[e]||[],{acumulado:t,acumuladoAteOMes:o}=function(e,a){if(null==e)return{acumulado:{},acumuladoAteOMes:[]};let t=e[a]||{},l=s()(t.mes,"YYYY-MM"),n=l.clone().add(-5,"month");return{acumulado:t,acumuladoAteOMes:Object.values(e||{}).filter(e=>{let a=s()(e.mes,"YYYY-MM");return a.isSameOrAfter(n)&&a.isSameOrBefore(l)})}}(n,e),i=a.map(e=>e.valor).filter(Boolean).reduce((e,a)=>e.plus(a),(0,x.Z)(0)),c=s()(e,C);return(0,l.jsxs)("section",{className:"card my-3",children:[(0,l.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center flex-column flex-lg-row gap-3",children:[(0,l.jsxs)("h4",{className:"m-0",children:["Periodo de: ",c.format(S)]}),(null==t?void 0:t.totalAcumulado)&&(0,l.jsxs)("small",{children:["Valor em caixa no periodo: ",r.C.toCurrency(t.totalAcumulado)]}),(0,l.jsxs)("div",{className:"actions d-flex gap-3",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>E(c),children:"Remover M\xeas"}),(0,l.jsx)(p.default,{href:"/".concat(k,"/editar-mes?month=").concat(e),className:"btn btn-outline-dark btn-sm",children:"Editar m\xeas"}),(0,l.jsx)(p.default,{href:"/".concat(k,"/copia?month=").concat(e),className:"btn btn-outline-dark btn-sm",children:"Copiar m\xeas"})]})]}),(0,l.jsxs)("div",{className:"card-body d-flex align-items-center align-items-lg-start flex-column-reverse flex-lg-row justify-content-lg-around",children:[(0,l.jsx)(m,{tableName:w,transacoesDoPeriodo:a}),!Y&&(0,l.jsx)(h,{transacoesDoPeriodo:a,transacoesAcumuladasPorMes:o}),Y&&(0,l.jsxs)("div",{className:"totals",children:[(0,l.jsx)("h5",{children:"Soma de todos os saldos"}),(0,l.jsx)("p",{children:r.C.toCurrency(i)}),(0,l.jsx)("small",{children:r.C.extenso(i)})]})]})]},e)})})}},2021:function(e,a,t){t.d(a,{u:function(){return s}});var l=t(7437),n=t(2265);function s(e){let{children:a,title:t,onClose:s,hideFooter:o}=e,[r,i]=(0,n.useState)(!0);function c(){i(!1),s&&s()}function d(e){var a;(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.id)==="modal"&&c()}function u(e){(null==e?void 0:e.key)==="Escape"&&c()}return(0,n.useEffect)(()=>(document.addEventListener("keydown",u,!1),()=>{document.removeEventListener("keydown",u,!1)}),[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"modal modal-lg fade ".concat(r&&"show"),id:"modal",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",style:{zIndex:99,display:r?"block":"none"},onClick:d,children:(0,l.jsx)("div",{className:"modal-dialog",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:t}),(0,l.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:c})]}),(0,l.jsx)("div",{className:"modal-body",children:a}),!o&&(0,l.jsx)("div",{className:"modal-footer",children:(0,l.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:c,children:"Close"})})]})})}),(0,l.jsx)("div",{className:"modal-backdrop fade ".concat(r&&"show"),style:{zIndex:98},onClick:d})]})}},6274:function(e,a,t){t.d(a,{C:function(){return i}});var l=t(2840),n=t(6947),s=t.n(n);let o=new Intl.NumberFormat("pt-br",{style:"currency",currency:"BRL"}),r=new Intl.NumberFormat("pt-br",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2});class i{static bigNumberToNumber(e){let a={...e};return Object.keys(a).forEach(e=>{let t=a[e];t instanceof l.Z?a[e]=null==t?void 0:t.toNumber():"object"==typeof t&&(a[e]=i.bigNumberToNumber(t))}),a}static extenso(e,a){var t;return(e instanceof l.Z&&(e=null==e?void 0:null===(t=e.integerValue())||void 0===t?void 0:t.toNumber()),null==e||isNaN(e)||!isFinite(e))?"":s()(e,a)}static toCurrency(e){return("string"==typeof e&&(e=Number(e)),e instanceof l.Z&&(e=null==e?void 0:e.toNumber()),null==e||isNaN(e)||!isFinite(e))?"":o.format(e)}static toPercent(e){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return("string"==typeof e&&(e=Number(e)),e instanceof l.Z&&(e=null==e?void 0:e.toNumber()),null==e||isNaN(e)||!isFinite(e))?"":(a&&(e/=100),r.format(e))}}},1196:function(e,a,t){t.d(a,{$I:function(){return m},$Q:function(){return u},x1:function(){return d}});var l=t(2265),n=t(6136);let s="label";function o(e,a){"function"==typeof e?e(a):e&&(e.current=a)}function r(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,l=[];e.datasets=a.map(a=>{let n=e.datasets.find(e=>e[t]===a[t]);return!n||!a.data||l.includes(n)?{...a}:(l.push(n),Object.assign(n,a),n)})}let i=(0,l.forwardRef)(function(e,a){let{height:t=150,width:i=300,redraw:c=!1,datasetIdKey:d,type:u,data:m,options:f,plugins:x=[],fallbackContent:h,updateMode:b,...v}=e,p=(0,l.useRef)(null),j=(0,l.useRef)(),N=()=>{p.current&&(j.current=new n.kL(p.current,{type:u,data:function(e){var a;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,l={labels:[],datasets:[]};return a=e.labels,l.labels=a,r(l,e.datasets,t),l}(m,d),options:f&&{...f},plugins:x}),o(a,j.current))},g=()=>{o(a,null),j.current&&(j.current.destroy(),j.current=null)};return(0,l.useEffect)(()=>{!c&&j.current&&f&&function(e,a){let t=e.options;t&&a&&Object.assign(t,a)}(j.current,f)},[c,f]),(0,l.useEffect)(()=>{if(!c&&j.current){var e,a;e=j.current.config.data,a=m.labels,e.labels=a}},[c,m.labels]),(0,l.useEffect)(()=>{!c&&j.current&&m.datasets&&r(j.current.config.data,m.datasets,d)},[c,m.datasets]),(0,l.useEffect)(()=>{j.current&&(c?(g(),setTimeout(N)):j.current.update(b))},[c,f,m.labels,m.datasets,b]),(0,l.useEffect)(()=>{j.current&&(g(),setTimeout(N))},[u]),(0,l.useEffect)(()=>(N(),()=>g()),[]),l.createElement("canvas",Object.assign({ref:p,role:"img",height:t,width:i},v),h)});function c(e,a){return n.kL.register(a),(0,l.forwardRef)((a,t)=>l.createElement(i,Object.assign({},a,{ref:t,type:e})))}let d=c("line",n.ST),u=c("bar",n.vn),m=c("doughnut",n.jI)}}]);