"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5216],{4807:(e,a,l)=>{l.d(a,{F:()=>o});var s=l(5155),t=l(8310);let r=[{title:"ultimo mes",value:t._X.ULTIMO_MES},{title:"3 ultimos meses",value:t._X.TRES_ULTIMOS_MESES},{title:"6 ultimos meses",value:t._X.SEIS_ULTIMOS_MESES},{title:"ultimo ano",value:t._X.ULTIMO_ANO},{title:"todo historico",value:t._X.TODO_HISTORICO}];function o(e){let{onChange:a,value:l}=e;return(0,s.jsxs)("form",{className:"periodo-form card card-material-1",children:[(0,s.jsx)("h5",{className:"card-header",children:"Escolha o periodo"}),(0,s.jsx)("div",{className:"d-xl-none my-3 px-3",children:(0,s.jsx)("select",{className:"form-select",id:"tipoReceita",onChange:e=>a(Number(e.target.value)),defaultValue:l,children:r.map((e,a)=>(0,s.jsx)("option",{value:e.value,children:e.title},e.value))})}),(0,s.jsx)("div",{className:"d-none d-xl-flex btn-group my-3 px-3",children:r.map((e,t)=>(0,s.jsxs)("label",{className:"btn btn-outline-secondary ".concat(e.value===l&&"active"),htmlFor:"periodosTransacoes".concat(t),children:[(0,s.jsx)("input",{type:"radio",className:"btn-check",name:"periodosTransacoes",id:"periodosTransacoes".concat(t),value:e.value,onChange:e=>a(Number(e.target.value)),checked:e.value===l}),e.title]},e.value))})]})}},5317:(e,a,l)=>{l.d(a,{S:()=>T});var s=l(5155),t=l(2940),r=l.n(t),o=l(4241),n=l(8870),i=l(2115),c=l(8555),d=l(5893),m=l(4208),u=l(8310),x=l(1586),h=l(130),p=l(3748);function v(e){let{transacoesDoPeriodo:a,tableName:l}=e,t=l||m.tw.TRANSACOES,r=t===m.tw.TRANSACOES,[o,u]=(0,i.useState)(null),x=a.filter(e=>{var a;return null==e||null==(a=e.valor)?void 0:a.isGreaterThan(0)}),p=null==x?void 0:x.reduce((e,a)=>e.plus(a.valor),new h.g(0)),v=a.filter(e=>{var a;return null==e||null==(a=e.valor)?void 0:a.isLessThanOrEqualTo(0)}),f=null==v?void 0:v.reduce((e,a)=>e.plus(a.valor),new h.g(0)),N=a.filter(e=>!(null==e?void 0:e.valor));return(0,s.jsxs)("section",{className:"d-flex lista-caixa w-100 gap-3 flex-column",children:[r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("ul",{className:"list-group list-group-material-1 w-100",children:[(0,s.jsxs)("li",{className:"list-group-item list-group-item-success",children:["Receitas (Soma: ",n.S.toCurrency(p),")"]}),0===x.length&&(0,s.jsx)("li",{className:"list-group-item list-group-item-warning",children:"Nenhuma receita encontrada"}),x.map((e,a)=>(0,s.jsx)(j,{item:e,setTransaction:u},"".concat(e.local,":").concat(a)))]}),(0,s.jsxs)("ul",{className:"list-group list-group-material-1 w-100",children:[(0,s.jsxs)("li",{className:"list-group-item list-group-item-danger",children:["Despesas (Soma: ",n.S.toCurrency(f),")"]}),0===v.length&&(0,s.jsx)("li",{className:"list-group-item list-group-item-warning",children:"Nenhuma despesa encontrada"}),v.map((e,a)=>(0,s.jsx)(j,{item:e,setTransaction:u},"".concat(e.local,":").concat(a)))]}),(0,s.jsx)("ul",{className:"list-group list-group-material-1 w-100",children:N.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("li",{className:"list-group-item list-group-item-warning",children:"Cadastro incompleto"}),N.map((e,a)=>(0,s.jsx)(j,{item:e,setTransaction:u},"".concat(e.local,":").concat(a)))]})})]}):(0,s.jsx)("ul",{className:"list-group list-group-material-1 w-100",children:a.map((e,a)=>(0,s.jsx)(j,{item:e,setTransaction:u},"".concat(e.local,":").concat(a)))}),o&&(0,s.jsx)(c.a,{hideFooter:!0,onClose:()=>u(null),title:"Detalhes da transa\xe7\xe3o: ".concat(null==o?void 0:o.local),children:(0,s.jsx)(d.p,{tableName:t,transacao:o,cleanStyle:!0,onClose:()=>u(null)})})]})}function j(e){var a,l,t;let{item:o,setTransaction:c,tableName:d}=e,{repository:h}=(0,p.r)(),[v,j]=(0,i.useState)(o),f=d===m.tw.TRANSACOES?"(".concat((null==h||null==(l=h.categoriaTransacoes)||null==(a=l.TODAS_DICT[o.categoriaId])?void 0:a.descricao)||"Sem categoria",")"):"";return(0,i.useEffect)(()=>{let e={...o};e.__parsedComentario=x.F.render(o.comentario),j(e)},[o]),(0,s.jsxs)("li",{className:"list-group-item ".concat(null!=(t=o.valor)?t:"list-group-item-warning"),children:[(0,s.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,s.jsxs)("h5",{children:[o.local," ",(0,s.jsx)("small",{className:"text-secondary",children:f})]}),(0,s.jsxs)("div",{className:"d-flex justify-content-between gap-3 flex-column flex-lg-row",children:[(0,s.jsx)("small",{children:r()(o.data).format("DD/MM/YY")}),void 0!==o.tipo&&(0,s.jsx)("small",{className:o.tipo===u.Do.FIXO?"text-primary":"text-info",children:o.tipo===u.Do.FIXO?"Fixo":"Vari\xe1vel"})]})]}),(0,s.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,s.jsx)("p",{children:o.valor?n.S.toCurrency(o.valor):"sem valor"}),(0,s.jsx)("button",{className:"btn btn-secondary",onClick:e=>c(o),children:"Editar"})]}),(0,s.jsx)("small",{dangerouslySetInnerHTML:{__html:v.__parsedComentario}})]})}var f=l(4065);function N(e){let{transacoesDoPeriodo:a,transacoesAcumuladasPorMes:l}=e,t=a.reduce((e,a)=>e.plus(a.valor||0),(0,h.A)(0));return(0,s.jsxs)("div",{className:"totals d-flex flex-column gap-3",children:[(0,s.jsx)("div",{className:"card card-material-1 w-100",children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h5",{children:"Balan\xe7o do m\xeas"}),(0,s.jsx)("p",{children:n.S.toCurrency(t)}),(0,s.jsx)("small",{children:n.S.extenso(t)})]})}),(0,s.jsx)("div",{className:"card card-material-1",children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h6",{children:"Receitas por categoria"}),(0,s.jsx)(g,{forReceitas:!0,transacoesDoPeriodo:a})]})}),(0,s.jsx)("div",{className:"card card-material-1",children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h6",{children:"Despesas por categoria"}),(0,s.jsx)(g,{transacoesDoPeriodo:a})]})}),(0,s.jsx)("div",{className:"card card-material-1",children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h6",{children:"Caixa acumulado por m\xeas"}),(0,s.jsx)(S,{transacoesAcumuladasPorMes:l})]})}),(0,s.jsx)("div",{className:"card card-material-1",children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h6",{children:"Receitas e despesas"}),(0,s.jsx)(b,{transacoesDoPeriodo:a})]})})]})}function g(e){let{transacoesDoPeriodo:a,forReceitas:l}=e,{repository:t}=(0,p.r)(),r=a.filter(e=>{var a,s;return l?null==e||null==(a=e.valor)?void 0:a.isGreaterThan(0):null==e||null==(s=e.valor)?void 0:s.isLessThanOrEqualTo(0)}),o=r.reduce((e,a)=>{let l=a.categoriaId||"Sem Categoria";return e[l]||(e[l]=(0,h.A)(0)),e[l]=e[l].plus(a.valor||0),e},{});return r.length>0?(0,s.jsx)(f.nu,{data:{labels:Object.keys(o).map(e=>{var a,l;return(null==t||null==(l=t.categoriaTransacoes)||null==(a=l.TODAS_DICT[e])?void 0:a.descricao)||e}),datasets:[{label:"soma em reais (R$)",data:Object.values(o).map(e=>e.toNumber()),hoverOffset:4}]},options:{responsive:!0,plugins:{legend:{position:"bottom"}}}}):(0,s.jsx)("div",{className:"alert alert-info",role:"alert",children:l?"Nenhuma receita encontrada.":"Nenhuma despesa encontrada."})}function b(e){let{transacoesDoPeriodo:a}=e,l=a.filter(e=>{var a;return e.valor&&(null==(a=e.valor)?void 0:a.isGreaterThan(0))}).reduce((e,a)=>e.plus(a.valor||0),(0,h.A)(0)),t=a.filter(e=>{var a;return e.valor&&(null==(a=e.valor)?void 0:a.isLessThanOrEqualTo(0))}).reduce((e,a)=>e.plus(a.valor||0),(0,h.A)(0));return(null==a?void 0:a.some(e=>e.valor))?(0,s.jsx)(f.nu,{data:{labels:["Receitas","Despesas"],datasets:[{label:"soma em reais (R$)",data:[l,t],backgroundColor:["#65a148","#dc3545"],hoverOffset:4}]},options:{responsive:!0,plugins:{legend:{position:"bottom"}}}}):(0,s.jsx)("div",{className:"alert alert-info",role:"alert",children:"Nenhum valor encontrado."})}function S(e){let{transacoesAcumuladasPorMes:a}=e;return(null==a?void 0:a.some(e=>null==e?void 0:e.totalAcumulado))?(0,s.jsx)(f.N1,{data:{labels:a.map(e=>e.mes),datasets:[{label:"acumulado at\xe9 o mes (R$)",data:a.map(e=>e.totalAcumulado)}]},options:{responsive:!0,plugins:{legend:{position:"bottom"}}}}):(0,s.jsx)("div",{className:"alert alert-info",role:"alert",children:"Nenhum valor encontrado."})}var O=l(6874),w=l.n(O);function M(e){let{somaPeriodo:a,transacoesDoPeriodo:l}=e;return(0,s.jsxs)("div",{className:"totals d-flex flex-column gap-3",children:[(0,s.jsx)("div",{className:"card card-material-1 w-100",children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h5",{children:"Soma de todos os saldos"}),(0,s.jsx)("p",{children:n.S.toCurrency(a)}),(0,s.jsx)("small",{children:n.S.extenso(a)})]})}),(0,s.jsx)("div",{className:"card card-material-1 w-100",children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h6",{children:"Saldos por patrimonio"}),(0,s.jsx)(y,{transacoesDoPeriodo:l})]})})]})}function y(e){let{transacoesDoPeriodo:a,forReceitas:l}=e,t=a.filter(e=>null==e?void 0:e.valor),r=t.reduce((e,a)=>{let l=a.local||"Sem local descrito";return e[l]||(e[l]=(0,h.g)(0)),e[l]=e[l].plus(a.valor||0),e},{});return t.length>0?(0,s.jsx)(f.nu,{data:{labels:Object.keys(r),datasets:[{label:"soma em reais (R$)",data:Object.values(r).map(e=>e.toNumber()),hoverOffset:4}]},options:{responsive:!0,plugins:{legend:{position:"bottom"}}}}):(0,s.jsx)("div",{className:"alert alert-info",role:"alert",children:l?"Nenhuma receita encontrada.":"Nenhuma despesa encontrada."})}function T(e){let{groupByDay:a,periodo:l,transacoesAcumuladaPorMes:t,tableName:c}=e,{isDbOk:d,repository:u,refresh:x}=(0,p.r)(),[j,f]=(0,i.useState)(!0),[g,b]=(0,i.useState)({}),S=c||m.tw.TRANSACOES,O=a?"YYYY-MM-DD":"YYYY-MM",y=a?"DD MMMM YYYY":"MMMM YYYY";async function T(){f(!0),await Y(),f(!1)}async function Y(){let e;b((S===m.tw.PATRIMONIO?await u.patrimonio.listPatrimonio(l):await u.transacoes.listCaixa(l)).reduce((e,a)=>{let l=r()(a.data).format(O),s=e[l]||[];return s.push(a),e[l]=s,e},{}))}async function A(e){confirm("Voc\xea tem certeza que deseja remover o m\xeas?")&&(S===m.tw.PATRIMONIO?await u.patrimonio.deletePeriod(e.format("MM"),e.format("YYYY")):await u.transacoes.deletePeriod(e.format("MM"),e.format("YYYY")),await x())}(0,i.useEffect)(()=>{d&&T()},[d,l]);let C=Object.keys(g),D=S===m.tw.PATRIMONIO,_=D?"patrimonio":"caixa";return(0,s.jsx)("section",{className:"periodos",children:j?(0,s.jsx)(o.a,{className:"align-self-center my-5"}):0===C.length?(0,s.jsx)("div",{className:"alert alert-info my-3",role:"alert",children:"Nenhuma transa\xe7\xe3o encontrada para o per\xedodo selecionado. Adicione uma nova transa\xe7\xe3o para come\xe7ar a utilizar o sistema."}):C.map(e=>{let a=g[e]||[],{acumulado:l,acumuladoAteOMes:o}=function(e,a){if(null==e)return{acumulado:{},acumuladoAteOMes:[]};let l=e[a]||{},s=r()(l.mes,"YYYY-MM"),t=s.clone().add(-5,"month");return{acumulado:l,acumuladoAteOMes:Object.values(e||{}).filter(e=>{let a=r()(e.mes,"YYYY-MM");return a.isSameOrAfter(t)&&a.isSameOrBefore(s)})}}(t,e),i=a.map(e=>e.valor).filter(Boolean).reduce((e,a)=>e.plus(a),(0,h.A)(0)),c=r()(e,O);return(0,s.jsxs)("section",{className:"my-3 d-flex flex-column gap-3",children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between align-items-center flex-column flex-lg-row gap-3",children:[(0,s.jsxs)("h4",{children:["Periodo de: ",c.format(y)]}),(null==l?void 0:l.totalAcumulado)&&(0,s.jsxs)("small",{children:["Valor em caixa no periodo: ",n.S.toCurrency(l.totalAcumulado)]}),(0,s.jsxs)("div",{className:"actions d-flex gap-3",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>A(c),children:"Remover M\xeas"}),(0,s.jsx)(w(),{href:"/".concat(_,"/editar-mes?month=").concat(e),className:"btn btn-outline-dark btn-sm",children:"Editar m\xeas"}),(0,s.jsx)(w(),{href:"/".concat(_,"/copia?month=").concat(e),className:"btn btn-outline-dark btn-sm",children:"Copiar m\xeas"})]})]}),(0,s.jsxs)("div",{className:"d-flex align-items-center align-items-lg-start flex-column-reverse flex-lg-row justify-content-lg-around gap-3",children:[(0,s.jsx)(v,{tableName:S,transacoesDoPeriodo:a}),!D&&(0,s.jsx)(N,{transacoesDoPeriodo:a,transacoesAcumuladasPorMes:o}),D&&(0,s.jsx)(M,{transacoesDoPeriodo:a,somaPeriodo:i})]})]},e)})})}}}]);