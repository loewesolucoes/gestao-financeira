"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4230],{4807:(e,a,s)=>{s.d(a,{F:()=>l});var o=s(5155),t=s(8310);let r=[{title:"ultimo mes",value:t._X.ULTIMO_MES},{title:"3 ultimos meses",value:t._X.TRES_ULTIMOS_MESES},{title:"6 ultimos meses",value:t._X.SEIS_ULTIMOS_MESES},{title:"ultimo ano",value:t._X.ULTIMO_ANO},{title:"todo historico",value:t._X.TODO_HISTORICO}];function l(e){let{onChange:a,value:s}=e;return(0,o.jsxs)("form",{className:"periodo-form card card-material-1",children:[(0,o.jsx)("h5",{className:"card-header",children:"Escolha o periodo"}),(0,o.jsx)("div",{className:"d-xl-none my-3 px-3",children:(0,o.jsx)("select",{className:"form-select",id:"tipoReceita",onChange:e=>a(Number(e.target.value)),defaultValue:s,children:r.map((e,a)=>(0,o.jsx)("option",{value:e.value,children:e.title},e.value))})}),(0,o.jsx)("div",{className:"d-none d-xl-flex btn-group my-3 px-3",children:r.map((e,t)=>(0,o.jsxs)("label",{className:"btn btn-outline-secondary ".concat(e.value===s&&"active"),htmlFor:"periodosTransacoes".concat(t),children:[(0,o.jsx)("input",{type:"radio",className:"btn-check",name:"periodosTransacoes",id:"periodosTransacoes".concat(t),value:e.value,onChange:e=>a(Number(e.target.value)),checked:e.value===s}),e.title]},e.value))})]})}},8039:(e,a,s)=>{s.d(a,{S:()=>y});var o=s(5155),t=s(2940),r=s.n(t),l=s(4241),n=s(8313),i=s(8870),c=s(130),d=s(3748),m=s(6315);function u(e){let{transacoesDoPeriodo:a,transacoesAcumuladasPorMes:s}=e,t=a.reduce((e,a)=>e.plus(a.valor||0),(0,c.A)(0));return(0,o.jsxs)("div",{className:"totals d-flex flex-xl-column flex-row flex-wrap justify-content-around gap-3",children:[(0,o.jsx)("div",{className:"card card-material-1 w-100",children:(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsx)("h5",{children:"Balan\xe7o do m\xeas"}),(0,o.jsx)("p",{children:i.S.toCurrency(t)}),(0,o.jsx)("small",{children:i.S.extenso(t)})]})}),(0,o.jsx)("div",{className:"card card-material-1",children:(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsx)("h6",{children:"Receitas por categoria"}),(0,o.jsx)(h,{forReceitas:!0,transacoesDoPeriodo:a})]})}),(0,o.jsx)("div",{className:"card card-material-1",children:(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsx)("h6",{children:"Despesas por categoria"}),(0,o.jsx)(h,{transacoesDoPeriodo:a})]})}),(0,o.jsx)("div",{className:"card card-material-1",children:(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsx)("h6",{children:"Caixa acumulado por m\xeas"}),(0,o.jsx)(p,{transacoesAcumuladasPorMes:s})]})}),(0,o.jsx)("div",{className:"card card-material-1",children:(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsx)("h6",{children:"Receitas e despesas"}),(0,o.jsx)(x,{transacoesDoPeriodo:a})]})})]})}function h(e){let{transacoesDoPeriodo:a,forReceitas:s}=e,{repository:t}=(0,d.r)(),r=a.filter(e=>{var a,o;return s?null==e||null==(a=e.valor)?void 0:a.isGreaterThan(0):null==e||null==(o=e.valor)?void 0:o.isLessThanOrEqualTo(0)}),l=r.reduce((e,a)=>{let s=a.categoriaId||"Sem Categoria";return e[s]||(e[s]=(0,c.A)(0)),e[s]=e[s].plus(a.valor||0),e},{}),n=Object.keys(l).map(e=>{var a,s;return(null==t||null==(s=t.categoriaTransacoes)||null==(a=s.TODAS_DICT[e])?void 0:a.descricao)||e}),i=Object.values(l).map(e=>s?e.toNumber():e.abs().toNumber());return r.length>0?(0,o.jsx)(m._x,{type:"pie",series:i,options:{labels:n,legend:{position:"bottom"},responsive:[{breakpoint:480,options:{legend:{position:"bottom"}}}]},width:"100%",height:300}):(0,o.jsx)("div",{className:"alert alert-info",role:"alert",children:s?"Nenhuma receita encontrada.":"Nenhuma despesa encontrada."})}function x(e){let{transacoesDoPeriodo:a}=e,s=a.filter(e=>{var a;return e.valor&&(null==(a=e.valor)?void 0:a.isGreaterThan(0))}).reduce((e,a)=>e.plus(a.valor||0),(0,c.A)(0)),t=a.filter(e=>{var a;return e.valor&&(null==(a=e.valor)?void 0:a.isLessThanOrEqualTo(0))}).reduce((e,a)=>e.plus(a.valor||0),(0,c.A)(0));return(null==a?void 0:a.some(e=>e.valor))?(0,o.jsx)(m._x,{type:"pie",series:[s.toNumber(),t.abs().toNumber()],options:{labels:["Receitas","Despesas"],colors:["#65a148","#dc3545"],legend:{position:"bottom"},responsive:[{breakpoint:480,options:{legend:{position:"bottom"}}}]},width:"100%",height:300}):(0,o.jsx)("div",{className:"alert alert-info",role:"alert",children:"Nenhum valor encontrado."})}function p(e){let{transacoesAcumuladasPorMes:a}=e,s=null==a?void 0:a.some(e=>null==e?void 0:e.totalAcumulado),t=a.map(e=>e.mes),r=a.map(e=>e.totalAcumulado);return s?(0,o.jsx)(m._x,{type:"area",series:[{name:"acumulado at\xe9 o mes (R$)",data:r}],options:{chart:{type:"area",zoom:{enabled:!1,autoScaleYaxis:!0},toolbar:{show:!1}},xaxis:{type:"datetime",categories:t},yaxis:{labels:{formatter:e=>i.S.toCurrency(e)}},dataLabels:{enabled:!1},legend:{position:"bottom"},responsive:[{breakpoint:480,options:{legend:{position:"bottom"}}}]},width:"100%",height:300}):(0,o.jsx)("div",{className:"alert alert-info",role:"alert",children:"Nenhum valor encontrado."})}var v=s(6874),j=s.n(v),f=s(2115),b=s(4208);function N(e){let{somaPeriodo:a,transacoesDoPeriodo:s}=e;return(0,o.jsxs)("div",{className:"totals d-flex flex-column gap-3",children:[(0,o.jsx)("div",{className:"card card-material-1 w-100",children:(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsx)("h5",{children:"Soma de todos os saldos"}),(0,o.jsx)("p",{children:i.S.toCurrency(a)}),(0,o.jsx)("small",{children:i.S.extenso(a)})]})}),(0,o.jsx)("div",{className:"card card-material-1 w-100",children:(0,o.jsxs)("div",{className:"card-body",children:[(0,o.jsx)("h6",{children:"Saldos por patrimonio"}),(0,o.jsx)(g,{transacoesDoPeriodo:s})]})})]})}function g(e){let{transacoesDoPeriodo:a,forReceitas:s}=e,t=a.filter(e=>null==e?void 0:e.valor),r=t.reduce((e,a)=>{let s=a.local||"Sem local descrito";return e[s]||(e[s]=(0,c.g)(0)),e[s]=e[s].plus(a.valor||0),e},{}),l=Object.keys(r),n=Object.values(r).map(e=>e.toNumber());return t.length>0?(0,o.jsx)(m._x,{type:"donut",series:n,options:{chart:{type:"donut"},labels:l,legend:{position:"bottom"},responsive:[{breakpoint:480,options:{legend:{position:"bottom"}}}]},width:"100%",height:320}):(0,o.jsx)("div",{className:"alert alert-info",role:"alert",children:s?"Nenhuma receita encontrada.":"Nenhuma despesa encontrada."})}function y(e){let{groupByDay:a,periodo:s,transacoesAcumuladaPorMes:t,tableName:m}=e,{isDbOk:h,repository:x,refresh:p}=(0,d.r)(),[v,g]=(0,f.useState)(!0),[y,M]=(0,f.useState)({}),Y=m||b.tw.TRANSACOES,S=a?"YYYY-MM-DD":"YYYY-MM",O=a?"DD MMMM YYYY":"MMMM YYYY";async function w(){g(!0),await T(),g(!1)}async function T(){let e;M((Y===b.tw.PATRIMONIO?await x.patrimonio.listPatrimonio(s):await x.transacoes.listCaixa(s)).reduce((e,a)=>{let s=r()(a.data).format(S),o=e[s]||[];return o.push(a),e[s]=o,e},{}))}async function A(e){confirm("Voc\xea tem certeza que deseja remover o m\xeas?")&&(Y===b.tw.PATRIMONIO?await x.patrimonio.deletePeriod(e.format("MM"),e.format("YYYY")):await x.transacoes.deletePeriod(e.format("MM"),e.format("YYYY")),await p())}(0,f.useEffect)(()=>{h&&w()},[h,s]);let _=Object.keys(y),P=Y===b.tw.PATRIMONIO,k=P?"patrimonio":"caixa";return(0,o.jsx)("section",{className:"periodos",children:v?(0,o.jsx)(l.a,{className:"align-self-center my-5"}):0===_.length?(0,o.jsx)("div",{className:"alert alert-info my-3",role:"alert",children:"Nenhuma transa\xe7\xe3o encontrada para o per\xedodo selecionado. Adicione uma nova transa\xe7\xe3o para come\xe7ar a utilizar o sistema."}):_.map(e=>{let a=y[e]||[],{acumulado:s,acumuladoAteOMes:l}=function(e,a){if(null==e)return{acumulado:{},acumuladoAteOMes:[]};let s=e[a]||{},o=r()(s.mes,"YYYY-MM"),t=o.clone().add(-5,"month");return{acumulado:s,acumuladoAteOMes:Object.values(e||{}).filter(e=>{let a=r()(e.mes,"YYYY-MM");return a.isSameOrAfter(t)&&a.isSameOrBefore(o)})}}(t,e),d=a.map(e=>e.valor).filter(Boolean).reduce((e,a)=>e.plus(a),(0,c.A)(0)),m=r()(e,S);return(0,o.jsxs)("section",{className:"my-3 d-flex flex-column gap-3",children:[(0,o.jsxs)("div",{className:"d-flex justify-content-between align-items-center flex-column flex-xl-row gap-3",children:[(0,o.jsxs)("h4",{children:["Periodo de: ",m.format(O)]}),(null==s?void 0:s.totalAcumulado)&&(0,o.jsxs)("small",{children:["Valor em caixa no periodo: ",i.S.toCurrency(s.totalAcumulado)]}),(0,o.jsxs)("div",{className:"actions d-flex gap-3",children:[(0,o.jsx)("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>A(m),children:"Remover M\xeas"}),(0,o.jsx)(j(),{href:"/".concat(k,"/editar-mes?month=").concat(e),className:"btn btn-outline-dark btn-sm",children:"Editar m\xeas"}),(0,o.jsx)(j(),{href:"/".concat(k,"/copia?month=").concat(e),className:"btn btn-outline-dark btn-sm",children:"Copiar m\xeas"})]})]}),(0,o.jsxs)("div",{className:"d-flex align-items-center align-items-xl-start flex-column-reverse flex-xl-row justify-content-xl-around gap-3",children:[(0,o.jsx)(n.E,{tableName:Y,transacoesDoPeriodo:a}),!P&&(0,o.jsx)(u,{transacoesDoPeriodo:a,transacoesAcumuladasPorMes:l}),P&&(0,o.jsx)(N,{transacoesDoPeriodo:a,somaPeriodo:d})]})]},e)})})}}}]);