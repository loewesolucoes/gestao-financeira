(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9127],{3513:function(e,a,t){Promise.resolve().then(t.bind(t,916))},3723:function(e,a,t){"use strict";t.d(a,{V:function(){return b}});var l=t(7437),n=t(7398),s=t.n(n),o=t(9376),i=t(1491),r=t(2265),c=t(5447),d=t(9820),u=t(3448),m=t(3463),x=t(569),f=t(2249),h=t(8651),p=t(7765),j=t(7460),g=t(8493);let v=new Date;function b(e){let{isCopy:a,tableName:t}=e,n=t||j.H$.TRANSACOES,{params:b}=(0,p.T)(),y=b.get("month"),C=s()(y,"YYYY-MM"),Y=(0,o.useRouter)(),{isDbOk:M,repository:w}=(0,i.y)(),[S,E]=(0,r.useState)(!0),[O,D]=(0,r.useState)(v),[k,I]=(0,r.useState)([]),[P,F]=(0,r.useState)([]),[A,R]=(0,r.useState)(),[_,T]=(0,r.useState)(!1),$=n===j.H$.PATRIMONIO;async function H(){let e;E(!0),e=n===j.H$.PATRIMONIO?await w.patrimonio.listByMonth(C.format("MM"),C.format("YYYY")):await w.transacoes.listByMonth(C.format("MM"),C.format("YYYY")),a&&e.forEach(e=>{delete e.id,delete e.createdDate,delete e.updatedDate,e.data=v}),I(e),E(!1)}async function V(){if(!confirm("Voc\xea tem certeza?"))return;E(!0);let e=[...k];a&&e.forEach(e=>{e.data=e.data===v?O:e.data}),e.forEach((e,a)=>{e.ordem=a}),$&&e.forEach((e,a)=>{delete e.categoriaId,delete e.tipo}),await Promise.all(P.filter(e=>e.id).map(e=>w.delete(n,e.id))),await w.saveAll(n,e),E(!1),Y.push($?"/patrimonio":"/caixa")}function B(e){let a=k.indexOf(e),t=[...k];t.splice(a,1),I(t),F([...P,e])}(0,r.useEffect)(()=>{M&&H()},[M]);let X=k.filter(e=>null==e?void 0:e.valor).reduce((e,a)=>a.valor.plus(e),(0,h.Z)(0));return(0,l.jsxs)(l.Fragment,{children:[S?(0,l.jsx)(c.a,{className:"align-self-center my-5"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"d-flex justify-content-between align-items-center align-items-lg-end flex-column flex-lg-row gap-3",children:[(0,l.jsx)(N,{total:X}),(0,l.jsx)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:(0,l.jsx)("button",{type:"button",className:"btn btn-dark",onClick:e=>T(!0),children:"Adicionar nova"})})]}),(0,l.jsx)(f.Z5,{onDragEnd:function(e){var a;let t=[...k],l=null===(a=e.destination)||void 0===a?void 0:a.index,n=e.source.index,s=t[n];t.splice(n,1),t.splice(l,0,s),I(t)},children:(0,l.jsx)(f.bK,{droppableId:"droppable",children:(e,a)=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("ul",{...e.droppableProps,className:"list-group ".concat(a.isDraggingOver&&"text-bg-dark"),ref:e.innerRef,children:k.map((e,a)=>(0,l.jsx)(f._l,{draggableId:"".concat(e.local,":").concat(a),index:a,children:(a,t)=>{var n,o;return(0,l.jsxs)("li",{ref:a.innerRef,...a.draggableProps,...a.dragHandleProps,style:a.draggableProps.style,className:"list-group-item ".concat(!(null===(n=e.valor)||void 0===n?void 0:n.toNumber())&&"list-group-item-warning"," ").concat(t.isDragging&&"active"),children:[(0,l.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,l.jsx)("h5",{children:e.local}),(0,l.jsxs)("div",{className:"d-flex justify-content-between gap-3",children:[(0,l.jsx)("small",{children:s()(e.data).format("DD/MM/YY")}),void 0!==e.tipo&&(0,l.jsx)("small",{className:e.tipo===g.$P.FIXO?"text-primary":"text-info",children:e.tipo===g.$P.FIXO?"Fixo":"Vari\xe1vel"})]})]}),(0,l.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,l.jsx)("p",{children:(null===(o=e.valor)||void 0===o?void 0:o.toNumber())?d.C.toCurrency(e.valor):"sem valor"}),(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:[(0,l.jsx)("button",{className:"btn btn-secondary",onClick:a=>R(e),children:"Editar"}),(0,l.jsx)("button",{className:"btn btn-danger",onClick:a=>B(e),children:"Remover"})]})]}),(0,l.jsx)("small",{children:e.comentario})]})}},"".concat(e.local,":").concat(a)))}),e.placeholder]})})}),(0,l.jsx)("div",{className:"d-flex justify-content-center justify-content-lg-end",children:(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:[(0,l.jsx)(N,{total:X}),a&&(0,l.jsxs)("div",{className:"form-floating",children:[(0,l.jsx)(u.I,{type:"month",className:"form-control",id:"data",placeholder:"M\xeas a aplicar",value:O,onChange:e=>D(e)}),(0,l.jsx)("label",{htmlFor:"data",className:"form-label",children:"M\xeas a aplicar"})]}),(0,l.jsx)("button",{type:"button",className:"btn btn-primary",onClick:e=>V(),children:a?"Copiar transa\xe7\xf5es para o m\xeas":"Salvar transa\xe7\xf5es do m\xeas"})]})})]}),A&&(0,l.jsx)(m.u,{hideFooter:!0,onClose:()=>R(null),title:"Detalhes da transa\xe7\xe3o: ".concat(null==A?void 0:A.local),children:(0,l.jsx)(x.m,{tableName:n,transacao:A,cleanStyle:!0,onClose:()=>R(null),onCustomSubmit:e=>(function(e,a){let t=k.indexOf(e),l=[...k];l[t]={...a},I(l)})(A,e),onCustomDelete:e=>B(A)})}),_&&(0,l.jsx)(m.u,{hideFooter:!0,onClose:()=>T(!1),title:"Adicionar transa\xe7\xe3o",children:(0,l.jsx)(x.m,{tableName:n,cleanStyle:!0,onClose:()=>T(!1),onCustomSubmit:e=>(function(e){let a=[...k];a.push(e),I(a)})(e),onCustomDelete:e=>T(!1)})})]})}function N(e){let{total:a}=e;return(0,l.jsxs)("div",{className:"d-flex gap-3",children:[(0,l.jsx)("h5",{children:"Balan\xe7o do m\xeas"}),(0,l.jsxs)("div",{className:"d-flex flex-column",children:[(0,l.jsx)("p",{className:"m-0",children:d.C.toCurrency(a)}),(0,l.jsx)("small",{children:d.C.extenso(a)})]})]})}},916:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(7437),n=t(837);t(6974);var s=t(3723),o=t(7398),i=t.n(o),r=t(7765);function c(){let{params:e}=(0,r.T)(),a=e.get("month"),t=i()(a,"YYYY-MM");return(0,l.jsxs)("main",{className:"caixa container mt-3 d-flex flex-column gap-3",children:[(0,l.jsxs)("h1",{children:["Editar m\xeas: ",t.format("MMMM YYYY")]}),(0,l.jsx)(s.V,{isCopy:!1})]})}function d(){return(0,l.jsx)(n.A,{children:(0,l.jsx)(c,{})})}},6974:function(){}},function(e){e.O(0,[1390,4466,7674,6990,4960,1216,4598,8474,2959,837,6512,2971,5910,1744],function(){return e(e.s=3513)}),_N_E=e.O()}]);