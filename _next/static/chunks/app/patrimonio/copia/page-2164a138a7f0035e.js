(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[475],{9902:function(e,a,t){Promise.resolve().then(t.bind(t,7721))},3723:function(e,a,t){"use strict";t.d(a,{V:function(){return b}});var l=t(7437),n=t(7398),s=t.n(n),o=t(9376),r=t(6886),i=t(2265),c=t(5447),d=t(9820),m=t(3448),u=t(3463),x=t(569),f=t(2249),h=t(8651),p=t(7765),j=t(7460),g=t(8493);let v=new Date;function b(e){let{isCopy:a,tableName:t}=e,n=t||j.H$.TRANSACOES,{params:b}=(0,p.T)(),y=b.get("month"),C=s()(y,"YYYY-MM"),Y=(0,o.useRouter)(),{isDbOk:M,repository:w}=(0,r.y)(),[O,S]=(0,i.useState)(!0),[D,I]=(0,i.useState)(v),[P,k]=(0,i.useState)([]),[E,A]=(0,i.useState)([]),[F,R]=(0,i.useState)(),[_,T]=(0,i.useState)(!1),$=n===j.H$.PATRIMONIO;async function H(){let e;S(!0),e=n===j.H$.PATRIMONIO?await w.patrimonio.listByMonth(C.format("MM"),C.format("YYYY")):await w.transacoes.listByMonth(C.format("MM"),C.format("YYYY")),a&&e.forEach(e=>{delete e.id,delete e.createdDate,delete e.updatedDate,e.data=v}),k(e),S(!1)}async function V(){if(!confirm("Voc\xea tem certeza?"))return;S(!0);let e=[...P];a&&e.forEach(e=>{e.data=e.data===v?D:e.data}),e.forEach((e,a)=>{e.ordem=a}),await Promise.all(E.filter(e=>e.id).map(e=>w.delete(n,e.id))),await w.saveAll(n,e),S(!1),Y.push($?"/patrimonio":"/caixa")}function B(e){let a=P.indexOf(e),t=[...P];t.splice(a,1),k(t),A([...E,e])}(0,i.useEffect)(()=>{M&&H()},[M]);let X=P.filter(e=>null==e?void 0:e.valor).reduce((e,a)=>a.valor.plus(e),(0,h.Z)(0));return(0,l.jsxs)(l.Fragment,{children:[O?(0,l.jsx)(c.a,{className:"align-self-center my-5"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"d-flex justify-content-between align-items-center align-items-lg-end flex-column flex-lg-row gap-3",children:[(0,l.jsx)(N,{total:X}),(0,l.jsx)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:(0,l.jsx)("button",{type:"button",className:"btn btn-dark",onClick:e=>T(!0),children:"Adicionar nova"})})]}),(0,l.jsx)(f.Z5,{onDragEnd:function(e){var a;let t=[...P],l=null===(a=e.destination)||void 0===a?void 0:a.index,n=e.source.index,s=t[n];t.splice(n,1),t.splice(l,0,s),k(t)},children:(0,l.jsx)(f.bK,{droppableId:"droppable",children:(e,a)=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("ul",{...e.droppableProps,className:"list-group ".concat(a.isDraggingOver&&"text-bg-dark"),ref:e.innerRef,children:P.map((e,a)=>(0,l.jsx)(f._l,{draggableId:"".concat(e.local,":").concat(a),index:a,children:(a,t)=>{var n,o;return(0,l.jsxs)("li",{ref:a.innerRef,...a.draggableProps,...a.dragHandleProps,style:a.draggableProps.style,className:"list-group-item ".concat(!(null===(n=e.valor)||void 0===n?void 0:n.toNumber())&&"list-group-item-warning"," ").concat(t.isDragging&&"active"),children:[(0,l.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,l.jsx)("h5",{children:e.local}),(0,l.jsxs)("div",{className:"d-flex justify-content-between gap-3",children:[(0,l.jsx)("small",{children:s()(e.data).format("DD/MM/YY")}),void 0!==e.tipo&&(0,l.jsx)("small",{className:e.tipo===g.$P.FIXO?"text-primary":"text-info",children:e.tipo===g.$P.FIXO?"Fixo":"Vari\xe1vel"})]})]}),(0,l.jsxs)("div",{className:"d-flex w-100 justify-content-between gap-3",children:[(0,l.jsx)("p",{children:(null===(o=e.valor)||void 0===o?void 0:o.toNumber())?d.C.toCurrency(e.valor):"sem valor"}),(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:[(0,l.jsx)("button",{className:"btn btn-secondary",onClick:a=>R(e),children:"Editar"}),(0,l.jsx)("button",{className:"btn btn-danger",onClick:a=>B(e),children:"Remover"})]})]}),(0,l.jsx)("small",{children:e.comentario})]})}},"".concat(e.local,":").concat(a)))}),e.placeholder]})})}),(0,l.jsx)("div",{className:"d-flex justify-content-center justify-content-lg-end",children:(0,l.jsxs)("div",{className:"d-flex gap-3 flex-column flex-lg-row",children:[(0,l.jsx)(N,{total:X}),a&&(0,l.jsxs)("div",{className:"form-floating",children:[(0,l.jsx)(m.I,{type:"month",className:"form-control",id:"data",placeholder:"M\xeas a aplicar",value:D,onChange:e=>I(e)}),(0,l.jsx)("label",{htmlFor:"data",className:"form-label",children:"M\xeas a aplicar"})]}),(0,l.jsx)("button",{type:"button",className:"btn btn-primary",onClick:e=>V(),children:a?"Copiar transa\xe7\xf5es para o m\xeas":"Salvar transa\xe7\xf5es do m\xeas"})]})})]}),F&&(0,l.jsx)(u.u,{hideFooter:!0,onClose:()=>R(null),title:"Detalhes da transa\xe7\xe3o: ".concat(null==F?void 0:F.local),children:(0,l.jsx)(x.m,{tableName:n,transacao:F,cleanStyle:!0,onClose:()=>R(null),onCustomSubmit:e=>(function(e,a){let t=P.indexOf(e),l=[...P];l[t]={...a},k(l)})(F,e),onCustomDelete:e=>B(F)})}),_&&(0,l.jsx)(u.u,{hideFooter:!0,onClose:()=>T(!1),title:"Adicionar transa\xe7\xe3o",children:(0,l.jsx)(x.m,{tableName:n,cleanStyle:!0,onClose:()=>T(!1),onCustomSubmit:e=>(function(e){let a=[...P];a.push(e),k(a)})(e),onCustomDelete:e=>T(!1)})})]})}function N(e){let{total:a}=e;return(0,l.jsxs)("div",{className:"d-flex gap-3",children:[(0,l.jsx)("h5",{children:"Balan\xe7o do m\xeas"}),(0,l.jsxs)("div",{className:"d-flex flex-column",children:[(0,l.jsx)("p",{className:"m-0",children:d.C.toCurrency(a)}),(0,l.jsx)("small",{children:d.C.extenso(a)})]})]})}},7721:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return m}});var l=t(7437),n=t(7340);t(429);var s=t(3723),o=t(7398),r=t.n(o),i=t(7765),c=t(7460);function d(){let{params:e}=(0,i.T)(),a=e.get("month"),t=r()(a,"YYYY-MM");return(0,l.jsxs)("main",{className:"patrimonio container mt-3 d-flex flex-column gap-3",children:[(0,l.jsxs)("h1",{children:["Copiar transa\xe7\xf5es do m\xeas: ",t.format("MMMM YYYY")]}),(0,l.jsx)(s.V,{isCopy:!0,tableName:c.H$.PATRIMONIO})]})}function m(){return(0,l.jsx)(n.A,{children:(0,l.jsx)(d,{})})}},429:function(){}},function(e){e.O(0,[7509,4466,7674,6990,4960,1216,1421,8474,2959,7340,6512,2971,5910,1744],function(){return e(e.s=9902)}),_N_E=e.O()}]);